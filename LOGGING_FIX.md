# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –î–∞—Ç–∞: 2025-10-20

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

#### 1. –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏–ª–æ—Å—å 2 —Ä–∞–∑–∞ –∏–∑-–∑–∞ –¥–≤–æ–π–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö –ª–æ–≥–≥–µ—Ä–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –í –º–µ—Ç–æ–¥–∞—Ö `apiRequest()`, `apiResponse()`, `ws()`, `nav()`, `ui()`, `lifecycle()` –∏ –¥—Ä—É–≥–∏—Ö:
1. –°–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–ª—Å—è `print()` —Å —ç–º–æ–¥–∑–∏
2. –ü–æ—Ç–æ–º –≤—ã–∑—ã–≤–∞–ª—Å—è `d()` –∏–ª–∏ `i()`, –∫–æ—Ç–æ—Ä—ã–π **—Å–Ω–æ–≤–∞ –¥–µ–ª–∞–ª `print()`**

**–†–µ—à–µ–Ω–∏–µ:**
- –§–∞–π–ª: `lib/core/utils/logger.dart`
- –£–¥–∞–ª–µ–Ω—ã –≤—Ç–æ—Ä—ã–µ –≤—ã–∑–æ–≤—ã `d()` –∏ `i()` –∏–∑ –≤—Å–µ—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç `dart:developer`
- –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –¥–µ–ª–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `print()`

**–ö–æ–¥ –¥–æ:**
```dart
static void ws(String message) {
  if (kDebugMode || _enableReleaseLogging) {
    print('$_logPrefix üîå [WEBSOCKET] $message');
  }
  d(message, 'WEBSOCKET'); // ‚Üê –≠—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –≤—Ç–æ—Ä–æ–π print()!
}
```

**–ö–æ–¥ –ø–æ—Å–ª–µ:**
```dart
static void ws(String message) {
  if (kDebugMode || _enableReleaseLogging) {
    print('$_logPrefix üîå [WEBSOCKET] $message');
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑.

---

#### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–ª—é—á —Ç–æ–∫–µ–Ω–∞ –¥–ª—è WebSocket
**–ü—Ä–æ–±–ª–µ–º–∞:** `Token from storage: null` - WebSocket –Ω–µ –º–æ–≥ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á `access_token` –≤–º–µ—Å—Ç–æ `auth_token`.

**–†–µ—à–µ–Ω–∏–µ:**
- –§–∞–π–ª: `lib/main.dart` (—Å—Ç—Ä–æ–∫–∞ 113)
- –ò–∑–º–µ–Ω–µ–Ω–æ: `'access_token'` ‚Üí `'auth_token'`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏–Ω—ã —Ç–æ–∫–µ–Ω–∞

**–ö–æ–¥:**
```dart
// –ë—ã–ª–æ:
final token = await storage.read(key: 'access_token');
AppLogger.i('Token from storage: ${token != null ? "exists" : "null"}', 'Main');

// –°—Ç–∞–ª–æ:
final token = await storage.read(key: 'auth_token');
AppLogger.i('Token from storage: ${token != null ? "exists (${token.length} chars)" : "null"}', 'Main');
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** WebSocket —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.

---

#### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
**–§–∞–π–ª:** `lib/presentation/screens/main/home_screen.dart`

**–î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è:**

##### AppBar –∫–Ω–æ–ø–∫–∏:
- üîò –ü–æ–∏—Å–∫ (AppBar)
- üîò –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (AppBar)

##### FAB –∫–Ω–æ–ø–∫–∏:
- üîò –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É (FAB)
- üîò –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç (FAB)

##### –î–∏–∞–ª–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã:
- üîò –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ), –Ω–∞–∑–≤–∞–Ω–∏–µ: "..."
- üîò –û—Ç–º–µ–Ω–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã
- ‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —Å –ø—É—Å—Ç—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º

##### –î–∏–∞–ª–æ–≥–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞:
- üîò –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ), ID: "..."
- üîò –û—Ç–º–µ–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞
- ‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø—É—Å—Ç—ã–º ID

##### –ö–Ω–æ–ø–∫–∏ –ø–æ–≤—Ç–æ—Ä–∞:
- üîò –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —á–∞—Ç–æ–≤
- üîò –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

##### –ö–ª–∏–∫–∏ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å–ø–∏—Å–∫–∞:
- üîò –ù–∞–∂–∞—Ç —á–∞—Ç: [–Ω–∞–∑–≤–∞–Ω–∏–µ] (ID: [id])
- üîò –ù–∞–∂–∞—Ç –∫–æ–Ω—Ç–∞–∫—Ç: [–∏–º—è] (ID: [unique_id])

---

## üìä –ü–†–ò–ú–ï–†–´ –ù–û–í–´–• –õ–û–ì–û–í

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
flutter: üî∑ MVP_CLIENT üé® [UI_EVENT] HomeScreen: Search button clicked
flutter: üîµ üî∑ MVP_CLIENT [UI_EVENT] HomeScreen: Search button clicked
flutter: üî∑ MVP_CLIENT üîå [WEBSOCKET] ‚Üí ping to null
flutter: üîµ üî∑ MVP_CLIENT [WEBSOCKET] ‚Üí ping to null
flutter: ‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] Token from storage: null
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
üî∑ MVP_CLIENT üîÑ [LIFECYCLE] üöÄ Application starting...
‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] Token from storage: exists (550 chars)
‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] User authenticated, connecting WebSocket...
üî∑ MVP_CLIENT üîå [WEBSOCKET] ‚Üí ping to null
üî∑ MVP_CLIENT üé® [UI_EVENT] üîò –ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞: –ü–æ–∏—Å–∫ (AppBar)
üî∑ MVP_CLIENT üé® [UI_EVENT] üîò –ù–∞–∂–∞—Ç —á–∞—Ç: HITEST (ID: 2)
```

---

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

1. **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
2. **–õ–µ–≥–∫–æ –∏—Å–∫–∞—Ç—å** - –≤—Å–µ –ª–æ–≥–∏ –∏–º–µ—é—Ç –ø—Ä–µ—Ñ–∏–∫—Å `üî∑ MVP_CLIENT`
3. **–≠–º–æ–¥–∑–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫** - –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ UI —Å–æ–±—ã—Ç–∏—è –ø–æ üîò
4. **–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - –≤–∏–¥–Ω–æ —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–∞–∂–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
5. **WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Ç–æ–∫–µ–Ω —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è

---

## üîç –ö–ê–ö –ò–°–ö–ê–¢–¨ –í –õ–û–ì–ê–•

### –í—Å–µ UI —Å–æ–±—ã—Ç–∏—è (–∫–Ω–æ–ø–∫–∏):
```
üîò
```

### –í—Å–µ –æ—à–∏–±–∫–∏:
```
‚ùå
```

### –í—Å–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:
```
‚ö†Ô∏è
```

### WebSocket —Å–æ–±—ã—Ç–∏—è:
```
üîå
```

### –ù–∞–≤–∏–≥–∞—Ü–∏—è:
```
üß≠
```

### API –∑–∞–ø—Ä–æ—Å—ã:
```
üåê
```

---

## üöÄ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   flutter run
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   - –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
   - –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫ –≤–∏–¥–Ω—ã –ª–æ–≥–∏ —Å üîò
   - WebSocket –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å)

3. **–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**
   ```
   ‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] Auth state: isAuthenticated=true
   ‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] Token from storage: exists (1024 chars)
   ‚ÑπÔ∏è  üî∑ MVP_CLIENT [Main] User authenticated, connecting WebSocket...
   üîå üî∑ MVP_CLIENT [WS] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket: wss://pixeltoo.ru:8089
   ‚úÖ üî∑ MVP_CLIENT [WS] WebSocket —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!
   ```

---

## üìù –§–ê–ô–õ–´ –ò–ó–ú–ï–ù–ï–ù–´

1. `lib/core/utils/logger.dart` - —É–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
2. `lib/main.dart` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–ª—é—á —Ç–æ–∫–µ–Ω–∞
3. `lib/presentation/screens/main/home_screen.dart` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫

---

## ‚úÖ –ò–¢–û–ì–ò

- ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ
- ‚úÖ WebSocket —Ç–æ–∫–µ–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- ‚úÖ –í—Å–µ –∫–Ω–æ–ø–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –õ–æ–≥–∏ —á–∏—Å—Ç—ã–µ –∏ —á–∏—Ç–∞–µ–º—ã–µ
