# Melo Voice Project

**Melo Voice Project** ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–æ–≤ (MVP). –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ **Pixeltoo Lab**.

–°–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (–ø–æ–¥–ø–∏—Å–∫–∞–º–∏) –∏ WebSocket –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞–º–∏ WebRTC –ø—Ä–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–∞—Ö).

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
    *   –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ `unique_id` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π OTP (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ OTP –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ª–æ–≥–∏).
    *   –ó–∞—â–∏—Ç–∞ –æ—Ç brute-–∞—Ç–∞–∫ (rate limiting).
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞ CSRF-—Ç–æ–∫–µ–Ω–∞ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏:**
    *   –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–ª–µ—Ñ–æ–Ω, –∏–º—è, –Ω–∏–∫–Ω–µ–π–º) –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    *   End-to-End (E2E) —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö —á–µ—Ä–µ–∑ WebSocket.
    *   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ).
*   **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:**
    *   WebSocket –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (SDP, ICE-–∫–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è WebRTC).
    *   –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ ICE-—Å–µ—Ä–≤–µ—Ä–æ–≤.
*   **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
    *   FastAPI –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ HTTP API.
    *   –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ MySQL.
    *   –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ —á–µ—Ä–µ–∑ Redis.
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–ª—é—á–µ–π Redis.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

*   **–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ CSRF-—Ç–æ–∫–µ–Ω–∞:** –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ CSRF –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ `/register` –∏ `/login`, —Ç–∞–∫ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç —Ç–æ–∫–µ–Ω–∞ –¥–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/subscribe`). –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `csrf_token` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
*   **–û—à–∏–±–∫–∞ `'LoginRequest' object has no attribute 'client'`:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö `/register`, `/login` –∏ `/generate_otp` –ø—É—Ç–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `request: Request` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ IP-–∞–¥—Ä–µ—Å—É –∫–ª–∏–µ–Ω—Ç–∞ (`request.client.host`).

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   **Python** 3.10 –∏–ª–∏ –Ω–æ–≤–µ–µ
*   **MySQL** 8.0 –∏–ª–∏ –Ω–æ–≤–µ–µ
*   **Redis** 6.0 –∏–ª–∏ –Ω–æ–≤–µ–µ
*   SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (`fullchain.pem` –∏ `privkey.pem`, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç Let's Encrypt)

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python –∏–∑ —Ñ–∞–π–ª–∞ `requirements.txt`:

```txt
fastapi==0.111.0
uvicorn==0.30.1
sqlalchemy[asyncio]==2.0.31
aiomysql==0.2.0
redis==5.0.7
bcrypt==4.1.3
pyjwt==2.8.0
cryptography==42.0.8
apscheduler==3.10.4
websockets==12.0
pydantic==2.7.4
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    git clone https://github.com/Pixeltooru/mvp.git
    cd mvp
    pip install -r requirements.txt
    ```

2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö MySQL:**
    *   –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
        ```sql
        CREATE DATABASE mlo_v;
        ```

3.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Redis:**
    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä Redis –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `localhost:6379`.

4.  **–î–æ–±–∞–≤—å—Ç–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:**
    –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã `fullchain.pem` –∏ `privkey.pem` –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞—é—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–¥–µ (`main.py`):

*   `DB_URL`: URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL.
*   `REDIS_URL`: URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis.
*   `HTTP_PORT` / `WS_PORT`: –ü–æ—Ä—Ç—ã –¥–ª—è HTTP API –∏ WebSocket (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8088 –∏ 8089).
*   `ENCRYPTION_KEY_STR`: –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (base64, 32 –±–∞–π—Ç–∞).
*   `ACCESS_TOKEN_EXPIRE_MINUTES`: –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ JWT-—Ç–æ–∫–µ–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15 –º–∏–Ω—É—Ç).
*   `RATE_LIMIT_CALLS` / `RATE_LIMIT_PERIOD`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 60 —Å–µ–∫—É–Ω–¥).
*   `ICE_SERVERS`: –°–ø–∏—Å–æ–∫ STUN/TURN —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è WebRTC.
*   **CORS:** –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (`allow_origins`) –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö middleware.

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª `/var/mvp/mvp_server.log` –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ stdout —Å —É—Ä–æ–≤–Ω–µ–º `DEBUG`.

## üöÄ –ó–∞–ø—É—Å–∫

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π:
```bash
python main.py
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
*   HTTP-—Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `https://localhost:8088` (–∏–ª–∏ –≤–∞—à –¥–æ–º–µ–Ω)
*   WebSocket-—Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `wss://localhost:8089`

## üîå API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
*   **`POST /register`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
        ```json
        {
          "phone": "+79123456789",
          "name": "–ò–º—è",
          "nickname": "–ù–∏–∫",
          "password": "–ø–∞—Ä–æ–ª—å"
        }
        ```
    *   **–û—Ç–≤–µ—Ç:**
        ```json
        {
          "unique_id": "12345678",
          "e2e_key": "—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á"
        }
        ```

*   **`POST /login`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
        ```json
        {
          "identifier": "+79123456789 –∏–ª–∏ 12345678",
          "password": "–ø–∞—Ä–æ–ª—å",
          "otp": "123456"
        }
        ```
    *   **–û—Ç–≤–µ—Ç:**
        ```json
        {
          "access_token": "jwt_token",
          "token_type": "bearer",
          "csrf_token": "csrf_token"
        }
        ```

*   **`POST /generate_otp`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é OTP-–∫–æ–¥–∞. –ö–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/login` (–±–µ–∑ –ø–æ–ª—è `otp`).

### –° –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (—Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <jwt>`)
*   **`GET /ice_servers`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ ICE-—Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è WebRTC.

*   **`POST /subscribe`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–∞–∫—Ç—ã.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (—Ç—Ä–µ–±—É–µ—Ç `csrf_token`):**
        ```json
        {
          "target_id": "12345678",
          "secret": false,
          "csrf_token": "—Ç–æ–∫–µ–Ω_–∏–∑_–ª–æ–≥–∏–Ω–∞"
        }
        ```

*   **`POST /confirm_subscribe`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–∞–∫—Ç—ã.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/subscribe`.

*   **`GET /contacts`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫).

### –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ (–Ω–µ –¥–ª—è production!)
*   **`GET /debug/users`**
    *   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

## üì° WebSocket

*   **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** `wss://your-domain:8089/?token=<your_jwt_token>`
*   **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** JWT-—Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–µ `token`.
*   **–°–æ–æ–±—â–µ–Ω–∏—è:** –û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ (—Å–∏–≥–Ω–∞–ª–∏–Ω–≥ –¥–ª—è WebRTC) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é E2E-–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö JSON-—Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–∏–ø—ã: `subscription_request`, `offer`, `answer`, `ice_candidate` –∏ –¥—Ä.).

## üêõ –û—Ç–ª–∞–¥–∫–∞

1.  **–õ–æ–≥–∏:** –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Äî —Ñ–∞–π–ª `/var/mvp/mvp_server.log`. –ò—â–∏—Ç–µ –∑–∞–ø–∏—Å–∏ —Å —É—Ä–æ–≤–Ω—è–º–∏ `ERROR` –∏ `WARNING`.
2.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /debug/users`.
    *   –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ MySQL –Ω–∞–ø—Ä—è–º—É—é: `mysql -u root -p -h localhost mlo_v`.
3.  **Redis:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `redis-cli` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫—ç—à–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–∞–Ω–¥–∞ `KEYS "otp:*"`).
4.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:**
    *   –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é `curl`:
        ```bash
        curl -X POST "https://localhost:8088/login" \
        -H "Content-Type: application/json" \
        -d '{"identifier": "+79123456789", "password": "–ø–∞—Ä–æ–ª—å"}'
        ```
5.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket:**
    *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—É `wscat`:
        ```bash
        wscat -c "wss://localhost:8089/?token=<your_jwt_token>"
        ```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
*   **–û—à–∏–±–∫–∞ CSRF:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö POST-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `csrf_token`, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ.
*   **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π JWT:** –¢–æ–∫–µ–Ω –∂–∏–≤–µ—Ç 15 –º–∏–Ω—É—Ç. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥ –∑–∞–Ω–æ–≤–æ.
*   **–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (Rate Limit):** –£–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏.
*   **–û—à–∏–±–∫–∏ SSL:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã `fullchain.pem` –∏ `privkey.pem` –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.

## üè≠ –ü–µ—Ä–µ—Ö–æ–¥ –≤ production

*   –£–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/debug/users`).
*   –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É OTP —á–µ—Ä–µ–∑ SMS-—Å–µ—Ä–≤–∏—Å –≤–º–µ—Å—Ç–æ –≤—ã–≤–æ–¥–∞ –∫–æ–¥–∞ –≤ –ª–æ–≥–∏.
*   –í—ã–Ω–µ—Å–∏—Ç–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏ –ë–î) –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
*   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.
*   –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –∏ reverse proxy (–Ω–∞–ø—Ä–∏–º–µ—Ä, Nginx).

---

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ **issue** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub.
