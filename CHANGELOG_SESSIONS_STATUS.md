# Changelog: –°–µ—Å—Å–∏–∏ –∏ –°—Ç–∞—Ç—É—Å—ã –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –í–µ—Ä—Å–∏—è 3.2.0 - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ—Å—Å–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã

### ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- **–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏—è—Ö**: IP –∞–¥—Ä–µ—Å, —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (PC/Phone), User-Agent, –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π**: `GET /sessions/` - –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π**: `DELETE /sessions/{id}` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Å—Å–∏–∏
- **–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: `POST /sessions/revoke_all` - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ**: —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ª–æ–≥–∏–Ω–µ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

#### –°—Ç–∞—Ç—É—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å—ã**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ online/offline —Å—Ç–∞—Ç—É—Å–æ–≤
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∞–Ω–∏—è**: `POST /status/typing` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—á–∞—Ç–∞–µ—Ç
- **–°—Ç–∞—Ç—É—Å—ã –ø—Ä–æ—á—Ç–µ–Ω–∏—è**: `POST /status/read` - –æ—Ç–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
- **–°—Ç–∞—Ç—É—Å—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤**: `GET /status/contacts` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤—Å–µ—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

#### WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `status_change` - –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ—è–≤–∏–ª—Å—è/—É—à–µ–ª –∏–∑ —Å–µ—Ç–∏
- `typing_start/typing_stop` - –∫–æ–Ω—Ç–∞–∫—Ç –Ω–∞—á–∞–ª/–∑–∞–∫–æ–Ω—á–∏–ª –ø–µ—á–∞—Ç–∞—Ç—å
- `messages_read` - –∫–æ–Ω—Ç–∞–∫—Ç –ø—Ä–æ—á–∏—Ç–∞–ª —Å–æ–æ–±—â–µ–Ω–∏—è

### üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API

#### –ù–æ–≤—ã–µ endpoints
```
GET    /status/me           - –º–æ–π —Å—Ç–∞—Ç—É—Å
POST   /status/typing       - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–µ—á–∞—Ç–∞–Ω–∏—è
POST   /status/read         - –æ—Ç–º–µ—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
GET    /status/contacts     - —Å—Ç–∞—Ç—É—Å—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
POST   /status/online       - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–Ω–ª–∞–π–Ω
POST   /status/offline      - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ñ—Ñ–ª–∞–π–Ω

GET    /sessions/           - —Å–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π
DELETE /sessions/{id}       - —É–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é
POST   /sessions/revoke_all - —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ endpoints
- `POST /login` - —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å —Å–µ—Å—Å–∏–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### üìä –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### UserSession
```json
{
  "id": 1,
  "device_type": "phone",
  "device_name": "Android App",
  "ip_address": "192.168.1.100",
  "created_at": "2024-01-01T12:00:00Z",
  "last_activity": "2024-01-01T12:30:00Z",
  "is_current": true
}
```

#### UserStatus
```json
{
  "user_id": 12345,
  "status": "online",
  "last_seen": "2024-01-01T12:30:00Z",
  "is_typing_in_chat": 123
}
```

### üöÄ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö WebSocket —Å–æ–±—ã—Ç–∏–π**:
   - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ `status_change`, `typing_start`, `typing_stop`, `messages_read`
   - –û–±–Ω–æ–≤–ª—è—Ç—å UI –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤**:
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
   - –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç..."
   - –û—Ç–º–µ—á–∞—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏**:
   - –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Ä–∞–Ω "–ê–∫—Ç–∏–≤–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–≤–µ—Ä—à–∞—Ç—å —Å–µ—Å—Å–∏–∏ –Ω–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–ø–∏—Å–∫–µ —Å–µ—Å—Å–∏–π (–∏–∫–æ–Ω–∫–∏ PC/Phone/Web)
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –ø–µ—á–∞—Ç–∞–Ω–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ —Ç–µ–∫—Å—Ç–∞
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –æ—Ñ—Ñ–ª–∞–π–Ω –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã: `user_sessions`, `user_statuses`, `message_read_statuses`
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `migration_sessions_status.sql`

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –í—Å–µ –Ω–æ–≤—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–µ—Å—Å–∏–∏ –∏ —Å—Ç–∞—Ç—É—Å—ã —Å–≤–æ–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- WebSocket —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–∑–∞–∏–º–Ω—ã–º –∫–æ–Ω—Ç–∞–∫—Ç–∞–º

### üì± –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
